
<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Santander Renting | Mediolanum</title>
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --santander-red:#EA1D25; --text:#1a1a1a; --bg:#fff; --card:#f9f9f9;
  --muted:#6b7280; --radius:12px; --shadow:0 2px 12px rgba(0,0,0,.08);
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Open Sans',sans-serif;background:var(--bg);color:var(--text);padding:20px}
.container{max-width:720px;margin:auto}
header{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}
header img{width:auto}
.logo-mediolanum{max-height:50px}
.logo-santander{max-height:80px}
h1{text-align:center;font-size:24px;font-weight:700;color:var(--santander-red);margin-top:10px;margin-bottom:20px}

form{
  background:var(--card);border-radius:var(--radius);padding:24px;box-shadow:var(--shadow);
  display:grid;gap:12px;
}
label{font-weight:600;margin-bottom:2px;display:block}
input:not([type="checkbox"]), select, textarea{
  width:100%;padding:12px;border:1px solid #ccc;border-radius:8px;font-size:15px;
}
textarea{min-height:100px;resize:vertical}
select option[disabled]{color:#6b7280;}
select:invalid {color:#6b7280;}

.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media(max-width:640px){.grid-2{grid-template-columns:1fr}}

.consent{
  background:#f5f5f5;border:1px solid #ccc;padding:12px;border-radius:12px;
  display:flex;align-items:flex-start;gap:10px;font-size:14px;
}
.consent a{color:var(--santander-red);text-decoration:none}
.consent a:hover{text-decoration:underline}

button{
  background:var(--santander-red);color:#fff;border:none;padding:14px;border-radius:30px;
  font-weight:700;font-size:16px;cursor:pointer;transition:background .3s ease;width:100%;
}
button:hover{background:#c3001f}
button:disabled{opacity:.5;cursor:not-allowed}
.hint{font-size:12px;color:var(--muted)}
.success{color:#065f46}
.error{color:#b91c1c}
.row-note{text-align:right;font-size:12px;color:var(--muted)}
</style>
</head>
<body>
<div class="container">
<header>
  <img src="Logo_Gruppo_Mediolanum1.jpg" alt="Logo Mediolanum" class="logo-mediolanum">
  <img src="FA_SANTANDER_RENTING_CV_POS_RGB.png" alt="Logo Santander Renting" class="logo-santander">
</header>
<h1>Richiesta Offerta Noleggio</h1>

<form id="Mediolanum" method="POST" action="https://script.google.com/macros/s/AKfycbx0Y54xiq1jzfXw16vt_jHc7s8L3xixDw3vawy7vQ_1JidAV_ChOUUovYand8Fb1EyRcg/exec" autocomplete="off">
  <div class="row-note">* I campi contrassegnati con asterisco sono obbligatori.</div>


<div class="grid-2">
  <div>
    <label for="contact_name">Nome e Cognome *</label>
    <input id="contact_name" name="contact_name" required placeholder="Nome e Cognome">
  </div>

 

<div class="grid-2">
  <div>
    <label for="contact_name">Nome e Cognome *</label>
    <input id="contact_name" name="contact_name" required placeholder="Nome e Cognome">
  </div>

  
<div class="grid-2">
  <div>
    <label for="contact_name">Nome e Cognome *</label>
    <input id="contact_name" name="contact_name" required placeholder="Nome e Cognome">
  </div>
 
<select id="offerta" name="Offerta" required>
  <option value="" disabled selected>Seleziona…</option>
  <option>FIAT PANDA 1.0 firefly hybrid Pop s&amp;s 70cv</option>
  <option>NISSAN JUKE 1.0 DIG-T 114 Acenta Mt</option>
  <option>CITROEN C3 AIRCROSS Turbo 100 cv Manuale YOU</option>
  <option>MAZDA 2 1.5 vvt full hybrid electric Prime Line e-cvt</option>
  <option>HYUNDAI TUCSON 1.6 crdi 48V Exellence 2wd dct</option>
  <option>NISSAN X-TRAIL 1.5 MHEV Acenta CVT</option>
  <option>BMW X1sdrive18d auto</option>
  <option>BMW X6 xdrive30d Msport auto</option>
  <option>MAZDA CX-60 3.3L e-SKYACTIV MHEV Excl. Line Auto</option>
  <option>BMW X3 xDrive 20d</option>
  <option>AUDI Nuovo Q5 Sportback TDI 150kW quattro S tronic Business Advanced</option>
  <option>LEXUS Nuovo RX 350h Premium Hybrid Executive MY24</option>
</select>


  <div class="grid-2">
    <div>
      <label for="email">Email Cliente *</label>
      <input id="email" name="email" type="email" required placeholder="nome@azienda.it">
    </div>
    <div>
      <label for="tel">Cellulare Cliente *</label>
      <input id="tel" name="tel" required placeholder="+39 …">
    </div>
  </div>

  <label for="region">Regione (Sede) *</label>
  <select id="region" name="region" required>
    <option value="" disabled selected>Seleziona…</option>
    <option>Abruzzo</option><option>Basilicata</option><option>Calabria</option>
    <option>Campania</option><option>Emilia-Romagna</option><option>Friuli-Venezia Giulia</option>
    <option>Lazio</option><option>Liguria</option><option>Lombardia</option>
    <option>Marche</option><option>Molise</option><option>Piemonte</option>
    <option>Puglia</option><option>Sardegna</option><option>Sicilia</option>
    <option>Toscana</option><option>Trentino-Alto Adige</option><option>Umbria</option>
    <option>Valle d'Aosta</option><option>Veneto</option>
  </select>

  <label for="notes">Info Aggiuntive</label>
  <textarea id="notes" name="notes" placeholder="Scrivi qui eventuali informazioni utili…"></textarea>

  <div class="consent">
    <input type="checkbox" id="consenso" required>
    <label for="consenso">
      Dichiaro di aver letto l’<a href="https://www.santanderrenting.it/uploads/Informativa-privacy-clienti-prospect.pdf" target="_blank">Informativa Privacy</a> e di acconsentire al trattamento dei dati personali.
    </label>
  </div>

  <button id="submitBtn" type="submit" disabled>Invia richiesta</button>
  <p id="feedback" class="hint" aria-live="polite"></p>
</form>
</div>

<!-- Inserisci questo script alla fine del file HTML -->
<script>
const form = document.getElementById('Mediolanum');
const submitBtn = document.getElementById('submitBtn');
const consent = document.getElementById('consenso');
const feedback = document.getElementById('feedback');

consent.addEventListener('change', () => {
  submitBtn.disabled = !consent.checked;
});

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  feedback.textContent = '';
  if (!form.checkValidity()) {
    feedback.textContent = 'Compila tutti i campi obbligatori.';
    feedback.className = 'error';
    return;
  }

  // Converti i dati in formato leggibile da Apps Script
  const fd = new URLSearchParams(new FormData(form));

  try {
    const res = await fetch(form.action, {
      method: 'POST',
      body: fd,
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' }
    });

    if (res.ok) {
      feedback.textContent = 'Grazie! La richiesta è stata inviata correttamente.';
      feedback.className = 'success';
      form.reset();
      submitBtn.disabled = true;
    } else {
      throw new Error('HTTP ' + res.status);
    }
  } catch (err) {
    feedback.textContent = 'Invio non riuscito. Controlla URL /exec e permessi.';
    feedback.className = 'error';
  }
});
</script>
</body>
</html>
